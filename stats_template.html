<!-- –§–∞–π–ª: stats_template.html (–∑–∞–º–µ–Ω–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ stats_preview.html) -->
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–µ–≤—å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;background-color:#1e1e1e;color:#e0e0e0;padding:20px;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0}.message-container{background-color:#2a2a2a;border-radius:12px;max-width:500px;width:100%;box-shadow:0 8px 32px rgba(0,0,0,.4);overflow:hidden}.text-caption{padding:20px;line-height:1.6}.text-caption h2{font-size:1.5rem;margin:0 0 15px;color:#fff;font-weight:700}.text-caption p{margin:15px 0;color:#b0b0b0}.text-caption strong{color:#fff;font-weight:600}.stat-item{display:flex;justify-content:space-between;align-items:center;padding:4px 0}.stat-item .value{font-weight:700;color:#fff;font-size:1.1rem}.progress-bar-container{background-color:#444;border-radius:8px;height:12px;overflow:hidden;margin-top:8px}.progress-bar{height:100%;width:0;background:linear-gradient(90deg,rgba(23,162,184,1) 0%,rgba(0,123,255,1) 100%);border-radius:8px;transition:width 1.5s ease-in-out}.graph-image-container{background-color:#1e1e1e;padding:20px}
    </style>
</head>
<body>
    <div class="message-container">
        <div class="text-caption">
            <h2>üë§ –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, {{ user_first_name }}</h2>
            <p>
                <strong>üóìÔ∏è –ó–∞ —Å–µ–≥–æ–¥–Ω—è ({{ current_date }}):</strong><br>
                <div class="stat-item"><span>‚Ä¢ –°–¥–µ–ª–∞–Ω–æ —Å–∞–º–æ–∫–∞—Ç–æ–≤:</span><span class="value count-up">{{ today_count }}</span></div>
                <div class="stat-item"><span>‚Ä¢ –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è:</span><span class="value">{{ avg_time_today }}</span></div>
                <div class="stat-item"><span>‚Ä¢ –î—É–±–ª–∏–∫–∞—Ç—ã:</span><span class="value">{{ duplicates_today }}</span></div>
                <div class="stat-item"><span>‚Ä¢ –†–µ–π—Ç–∏–Ω–≥ –∑–∞ –¥–µ–Ω—å:</span><span class="value">{{ rank_today }} –∏–∑ {{ total_users_today }}</span></div>
            </p>
            <p>
                <strong>üéØ –ó–∞ –¥–µ–∫–∞–¥—É ({{ decade_dates }}):</strong><br>
                <span>–ü—Ä–æ–≥—Ä–µ—Å—Å: <strong>{{ decade_progress }} / {{ decade_norm }}</strong></span>
                <div class="progress-bar-container"><div class="progress-bar" id="decadeProgressBar"></div></div>
                <div class="stat-item" style="margin-top: 8px;"><span>‚Ä¢ –û—Å—Ç–∞–ª–æ—Å—å –¥–æ –ø—Ä–µ–º–∏–∏:</span><span class="value">{{ remaining_for_premium }}</span></div>
            </p>
            <p>
                <strong>üöÄ –ó–∞ –≤—Å–µ –≤—Ä–µ–º—è:</strong><br>
                <div class="stat-item"><span>‚Ä¢ –û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</span><span class="value count-up">{{ overall_total }}</span></div>
                <div class="stat-item"><span>‚Ä¢ –õ—É—á—à–∏–π –¥–µ–Ω—å:</span><span class="value">{{ best_day_count }} ({{ best_day_date }})</span></div>
                <div class="stat-item"><span>‚Ä¢ –†–∞–Ω–≥ –≤ –∫–æ–º–ø–∞–Ω–∏–∏:</span><span class="value">{{ overall_rank }} –º–µ—Å—Ç–æ</span></div>
            </p>
        </div>
        <div class="graph-image-container">
            <canvas id="hourlyChart"></canvas>
            <canvas id="weeklyChart" style="margin-top: 20px;"></canvas>
        </div>
    </div>
<script>
document.addEventListener('DOMContentLoaded',()=>{const progressBar=document.getElementById('decadeProgressBar');if(progressBar){const progressPercentage=({{decade_progress}}/{{decade_norm}})*100;setTimeout(()=>{progressBar.style.width=`${progressPercentage}%`},300)}
document.querySelectorAll('.count-up').forEach(el=>{const finalValue=parseInt(el.textContent,10);if(isNaN(finalValue)||finalValue===0){el.textContent=finalValue;return}
el.textContent='0';let startValue=0;const duration=1500;const stepTime=Math.max(1,Math.floor(duration/finalValue));const timer=setInterval(()=>{startValue+=1;if(startValue>=finalValue){el.textContent=finalValue;clearInterval(timer)}else{el.textContent=startValue}},stepTime)})}
);Chart.defaults.color='#a0a0a0';Chart.defaults.borderColor='rgba(255, 255, 255, 0.1)';const hourlyData={labels:{{hourly_labels_js|safe}},datasets:[{label:'–°–∞–º–æ–∫–∞—Ç–æ–≤ –≤ —á–∞—Å',data:{{hourly_data_js|safe}},backgroundColor:'rgba(0, 123, 255, 0.6)',borderColor:'rgba(0, 123, 255, 1)',borderWidth:1,borderRadius:4}]};const weeklyData={labels:{{weekly_labels_js|safe}},datasets:[{label:'–°–∞–º–æ–∫–∞—Ç–æ–≤ –≤ –¥–µ–Ω—å',data:{{weekly_data_js|safe}},backgroundColor:'rgba(23, 162, 184, 0.6)',borderColor:'rgba(23, 162, 184, 1)',borderWidth:1,borderRadius:4,tension:0.3,fill:true}]};new Chart(document.getElementById('hourlyChart'),{type:'bar',data:hourlyData,options:{plugins:{title:{display:true,text:'–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ–≥–æ–¥–Ω—è (–ø–æ —á–∞—Å–∞–º)',color:'#ffffff',font:{size:16}},legend:{display:false}},scales:{y:{beginAtZero:true,grid:{color:'rgba(255,255,255,0.1)'}},x:{grid:{display:false}}},responsive:true}});new Chart(document.getElementById('weeklyChart'),{type:'line',data:weeklyData,options:{plugins:{title:{display:true,text:'–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π',color:'#ffffff',font:{size:16}},legend:{display:false}},scales:{y:{beginAtZero:true,grid:{color:'rgba(255,255,255,0.1)'}},x:{grid:{display:false}}},responsive:true}});
</script>
</body>
</html>